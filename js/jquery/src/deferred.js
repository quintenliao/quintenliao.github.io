// build time:Wed Apr 15 2020 21:36:37 GMT+0800 (GMT+08:00)
define(["./core","./var/isFunction","./var/slice","./callbacks"],function(e,n,t){"use strict";function r(e){return e}function i(e){throw e}function o(e,t,r,i){var o;try{if(e&&n(o=e.promise)){o.call(e).done(t).fail(r)}else if(e&&n(o=e.then)){o.call(e,t,r)}else{t.apply(undefined,[e].slice(i))}}catch(e){r.apply(undefined,[e])}}e.extend({Deferred:function(t){var o=[["notify","progress",e.Callbacks("memory"),e.Callbacks("memory"),2],["resolve","done",e.Callbacks("once memory"),e.Callbacks("once memory"),0,"resolved"],["reject","fail",e.Callbacks("once memory"),e.Callbacks("once memory"),1,"rejected"]],c="pending",f={state:function(){return c},always:function(){l.done(arguments).fail(arguments);return this},"catch":function(e){return f.then(null,e)},pipe:function(){var t=arguments;return e.Deferred(function(r){e.each(o,function(e,i){var o=n(t[i[4]])&&t[i[4]];l[i[1]](function(){var e=o&&o.apply(this,arguments);if(e&&n(e.promise)){e.promise().progress(r.notify).done(r.resolve).fail(r.reject)}else{r[i[0]+"With"](this,o?[e]:arguments)}})});t=null}).promise()},then:function(t,c,f){var l=0;function a(t,o,c,f){return function(){var s=this,u=arguments,d=function(){var e,d;if(t<l){return}e=c.apply(s,u);if(e===o.promise()){throw new TypeError("Thenable self-resolution")}d=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(n(d)){if(f){d.call(e,a(l,o,r,f),a(l,o,i,f))}else{l++;d.call(e,a(l,o,r,f),a(l,o,i,f),a(l,o,r,o.notifyWith))}}else{if(c!==r){s=undefined;u=[e]}(f||o.resolveWith)(s,u)}},h=f?d:function(){try{d()}catch(n){if(e.Deferred.exceptionHook){e.Deferred.exceptionHook(n,h.stackTrace)}if(t+1>=l){if(c!==i){s=undefined;u=[n]}o.rejectWith(s,u)}}};if(t){h()}else{if(e.Deferred.getStackHook){h.stackTrace=e.Deferred.getStackHook()}window.setTimeout(h)}}}return e.Deferred(function(e){o[0][3].add(a(0,e,n(f)?f:r,e.notifyWith));o[1][3].add(a(0,e,n(t)?t:r));o[2][3].add(a(0,e,n(c)?c:i))}).promise()},promise:function(n){return n!=null?e.extend(n,f):f}},l={};e.each(o,function(e,n){var t=n[2],r=n[5];f[n[1]]=t.add;if(r){t.add(function(){c=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock)}t.add(n[3].fire);l[n[0]]=function(){l[n[0]+"With"](this===l?undefined:this,arguments);return this};l[n[0]+"With"]=t.fireWith});f.promise(l);if(t){t.call(l,l)}return l},when:function(r){var i=arguments.length,c=i,f=Array(c),l=t.call(arguments),a=e.Deferred(),s=function(e){return function(n){f[e]=this;l[e]=arguments.length>1?t.call(arguments):n;if(!--i){a.resolveWith(f,l)}}};if(i<=1){o(r,a.done(s(c)).resolve,a.reject,!i);if(a.state()==="pending"||n(l[c]&&l[c].then)){return a.then()}}while(c--){o(l[c],s(c),a.reject)}return a.promise()}});return e});
//rebuild by neat 